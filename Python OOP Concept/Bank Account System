from typing import List, Tuple


class BankAccount:
    """Simple bank account with basic validation and a transaction history."""

    def __init__(self, account_holder_name: str, account_number: str, balance: float = 0.0):
        if balance < 0:
            raise ValueError("Initial balance cannot be negative.")
        self.account_holder_name = account_holder_name
        self.account_number = account_number
        self._balance = float(balance)
        self.transaction_history: List[Tuple[str, float, float]] = []
        if self._balance > 0:
            self.transaction_history.append(("initial", self._balance, self._balance))

    @property
    def balance(self) -> float:
        """Read-only current balance."""
        return self._balance

    def deposit(self, amount: float) -> float:
        """Deposit a positive amount. Returns the new balance.

        Raises ValueError for non-positive amounts.
        """
        if amount <= 0:
            raise ValueError("Deposit amount must be positive.")
        self._balance += float(amount)
        self.transaction_history.append(("deposit", float(amount), self._balance))
        print(f"Deposited {amount}. New balance: {self._balance}")
        return self._balance

    def withdraw(self, amount: float) -> float:
        """Withdraw a positive amount if funds are sufficient. Returns the new balance.

        Raises ValueError for non-positive amounts or insufficient funds.
        """
        if amount <= 0:
            raise ValueError("Withdrawal amount must be positive.")
        if amount > self._balance:
            raise ValueError("Insufficient funds.")
        self._balance -= float(amount)
        self.transaction_history.append(("withdraw", float(amount), self._balance))
        print(f"Withdrew {amount}. New balance: {self._balance}")
        return self._balance

    def display_balance(self) -> None:
        """Print a human-readable summary of the account."""
        print("----- Account Details -----")
        print(f"Account Holder: {self.account_holder_name}")
        print(f"Account Number: {self.account_number}")
        print(f"Current Balance: {self._balance}")
        print("---------------------------")

    def to_dict(self) -> dict:
        return {
            "account_holder_name": self.account_holder_name,
            "account_number": self.account_number,
            "balance": self._balance,
            "transaction_count": len(self.transaction_history),
        }

    def __repr__(self) -> str:
        return f"<BankAccount {self.account_holder_name!r} #{self.account_number} balance={self._balance}>"


if __name__ == "__main__":
    acct = BankAccount("Alice", "1234", 50.0)
    acct.deposit(25)
    acct.withdraw(10)
    acct.display_balance()
    print(acct.to_dict())
